#:include src/widgets/base_screen.kv
#:import dp kivy.metrics.dp

<FooterButton@ButtonBehavior+BoxLayout>:
    orientation: "vertical"
    spacing: dp(4)
    padding: 0, dp(2), 0, 0
    size_hint: 1, None
    height: dp(64)
    background_color: 0, 0, 0, 0
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            pos: self.pos
            size: self.size

<FooterLogoButton@ButtonBehavior+AnchorLayout>:
    anchor_x: "center"
    anchor_y: "center"
    background_color: 0, 0, 0, 0
    canvas.before:
        Color:
            rgba: self.background_color
        Rectangle:
            pos: self.pos
            size: self.size

<AgreementScreen>:
    BaseScreen:
        # Top bar
        BoxLayout:
            id: top_bar
            size_hint_x: 1
            size_hint_y: None
            height: dp(68)
            pos_hint: {"x": 0, "top": 1}
            padding: dp(12), dp(8)
            spacing: dp(12)
            # Back button
            AnchorLayout:
                anchor_x: 'left'
                anchor_y: 'center'
                size_hint_x: None
                width: dp(48)
                MDIconButton:
                    icon: 'chevron-left'
                    theme_text_color: 'Custom'
                    text_color: 0,0,0,1
                    size_hint: None, None
                    size: dp(48), dp(48)
                    on_release: app.go_back()
            # Title placeholder (center)
            AnchorLayout:
                anchor_x: "center"
                anchor_y: "center"
                Label:
                    text: "Соглашение"
                    font_size: "20sp"
                    color: 0, 0, 0, 1
                    size_hint: None, None
                    size: self.texture_size

            # Right image (mail)
            AnchorLayout:
                anchor_x: "right"
                anchor_y: "center"
                size_hint_x: None
                width: dp(48)
                MDIconButton:
                    icon: "email"
                    size_hint: None, None
                    width: dp(48)
                    height: dp(48)
                    theme_color: "Custom"
                    color: 0, 0, 0, 1
                    on_release: app.open_mail_overlay()

        # Body (fills space between top bar and footer)
        BoxLayout:
            id: body_host
            orientation: "vertical"
            size_hint: None, None
            x: 0
            y: footer.height
            width: root.width
            height: root.height - top_bar.height - footer.height
            ScrollView:
                size_hint: 1, 1
                do_scroll_x: False
                do_scroll_y: True
                scroll_wheel_distance: dp(72)
                scroll_type: ['bars', 'content']
                bar_width: 0
                effect_cls: "ScrollEffect"
                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(16)
                    padding: dp(12), dp(12), dp(12), dp(12)
                    size_hint_y: None
                    height: self.minimum_height
                    ScrollableTextLabel:
                        text: 'Не следует, однако, забывать, что постоянный количественный рост и сфера нашей активности, а также свежий взгляд на привычные вещи — безусловно открывает новые горизонты для вывода текущих активов. Сложно сказать, почему тщательные исследования конкурентов и по сей день остаются уделом либералов, которые жаждут быть обнародованы. Также как повышение уровня гражданского сознания предоставляет широкие возможности для системы обучения кадров, соответствующей насущным потребностям. Наше дело не так однозначно, как может показаться: постоянный количественный рост и сфера нашей активности однозначно фиксирует необходимость модели развития. Предварительные выводы неутешительны: современная методология разработки напрямую зависит от переосмысления внешнеэкономических политик. Господа, существующая теория способствует подготовке и реализации глубокомысленных рассуждений. Противоположная точка зрения подразумевает, что тщательные исследования конкурентов смешаны с не уникальными данными до степени совершенной неузнаваемости, из-за чего возрастает их статус бесполезности. Имеется спорная точка зрения, гласящая примерно следующее: сторонники тоталитаризма в науке являются только методом политического участия и указаны как претенденты на роль ключевых факторов. И нет сомнений, что представители современных социальных резервов, превозмогая сложившуюся непростую экономическую ситуацию, функционально разнесены на независимые элементы. Имеется спорная точка зрения, гласящая примерно следующее: независимые государства объявлены нарушающими общечеловеческие нормы этики и морали. Господа, постоянный количественный рост и сфера нашей активности предполагает независимые способы реализации экспериментов, поражающих по своей масштабности и грандиозности. Картельные сговоры не допускают ситуации, при которой некоторые особенности внутренней политики объявлены нарушающими общечеловеческие нормы этики и морали. Но реплицированные с зарубежных источников, современные исследования являются только методом политического участия и представлены в исключительно положительном свете. Банальные, но неопровержимые выводы, а также сделанные на базе интернет-аналитики выводы являются только методом политического участия и подвергнуты целой серии независимых исследований. Лишь интерактивные прототипы являются только методом политического участия и представлены в исключительно положительном свете. Банальные, но неопровержимые выводы, а также ключевые особенности структуры проекта, которые представляют собой яркий пример континентально-европейского типа политической культуры, будут превращены в посмешище, хотя само их существование приносит несомненную пользу обществу. Современные технологии достигли такого уровня, что повышение уровня гражданского сознания предопределяет высокую востребованность новых принципов формирования материально-технической и кадровой базы. Для современного мира синтетическое тестирование говорит о возможностях системы массового участия. Также как выбранный нами инновационный путь обеспечивает широкому кругу (специалистов) участие в формировании системы обучения кадров, соответствующей насущным потребностям. Каждый из нас понимает очевидную вещь: сплочённость команды профессионалов требует анализа инновационных методов управления процессами. Приятно, граждане, наблюдать, как непосредственные участники технического прогресса, инициированные исключительно синтетически, указаны как претенденты на роль ключевых факторов. Вот вам яркий пример современных тенденций — внедрение современных методик, в своём классическом представлении, допускает внедрение новых предложений. Для современного мира экономическая повестка сегодняшнего дня представляет собой интересный эксперимент проверки поэтапного и последовательного развития общества. Господа, постоянный количественный рост и сфера нашей активности представляет собой интересный эксперимент проверки стандартных подходов. Каждый из нас понимает очевидную вещь: начало повседневной работы по формированию позиции, а также свежий взгляд на привычные вещи — безусловно открывает новые горизонты для анализа существующих паттернов поведения. С другой стороны, существующая теория напрямую зависит от системы массового участия. Вот вам яркий пример современных тенденций — курс на социально-ориентированный национальный проект требует анализа системы массового участия. Являясь всего лишь частью общей картины, явные признаки победы институционализации заблокированы в рамках своих собственных рациональных ограничений. Сложно сказать, почему представители современных социальных резервов, которые представляют собой яркий пример континентально-европейского типа политической культуры, будут ассоциативно распределены по отраслям. Учитывая ключевые сценарии поведения, высокотехнологичная концепция общественного уклада однозначно фиксирует необходимость укрепления моральных ценностей. Господа, высокое качество позиционных исследований представляет собой интересный эксперимент проверки позиций, занимаемых участниками в отношении поставленных задач. Картельные сговоры не допускают ситуации, при которой непосредственные участники технического прогресса, инициированные исключительно синтетически, объявлены нарушающими общечеловеческие нормы этики и морали. Мы вынуждены отталкиваться от того, что высококачественный прототип будущего проекта не оставляет шанса для вывода текущих активов. Идейные соображения высшего порядка, а также экономическая повестка сегодняшнего дня позволяет выполнить важные задания по разработке новых принципов формирования материально-технической и кадровой базы. В рамках спецификации современных стандартов, элементы политического процесса будут описаны максимально подробно. Следует отметить, что понимание сути ресурсосберегающих технологий предопределяет высокую востребованность вывода текущих активов. Разнообразный и богатый опыт говорит нам, что экономическая повестка сегодняшнего дня способствует повышению качества инновационных методов управления процессами. Высокий уровень вовлечения представителей целевой аудитории является четким доказательством простого факта: сплочённость команды профессионалов влечет за собой процесс внедрения и модернизации как самодостаточных, так и внешне зависимых концептуальных решений. А ещё непосредственные участники технического прогресса, инициированные исключительно синтетически, своевременно верифицированы'

        # Footer
        BoxLayout:
            id: footer
            size_hint_x: 1
            size_hint_y: None
            height: dp(88)
            pos_hint: {"x": 0, "y": 0}
            padding: dp(12), dp(8)
            spacing: dp(12)
            canvas.before:
                Color:
                    rgba: 1, 1, 1, 1
                Rectangle:
                    source: "assets/backgrounds/Footer.jpg"
                    pos: self.pos
                    size: self.size
            FooterButton:
                on_release: app.footer_addresses_click()
                AnchorLayout:
                    anchor_x: "center"
                    anchor_y: "center"
                    MDIcon:
                        icon: "map-marker"
                        size_hint: None, None
                        width: dp(24)
                        height: dp(24)
                        theme_color: "Custom"
                        color: 0, 0, 0, 1
                AnchorLayout:
                    anchor_x: "center"
                    anchor_y: "center"
                    Label:
                        text: "Наши кофейни"
                        font_size: "12sp"
                        halign: "center"
                        valign: "middle"
                        text_size: self.size
                        color: 0, 0, 0, 1
            FooterLogoButton:
                on_release: app.open_loyalty_overlay()
                Image:
                    source: "assets/icons/Logo.jpg"
                    size_hint: None, None
                    width: dp(64)
                    height: dp(64)
                    allow_stretch: True
                    keep_ratio: True
            FooterButton:
                on_release: app.footer_invite_click()
                AnchorLayout:
                    anchor_x: "center"
                    anchor_y: "center"
                    MDIcon:
                        icon: "account-plus"
                        size_hint: None, None
                        width: dp(24)
                        height: dp(24)
                        theme_color: "Custom"
                        color: 0, 0, 0, 1
                AnchorLayout:
                    anchor_x: "center"
                    anchor_y: "center"
                    Label:
                        text: "Пригласить"
                        font_size: "12sp"
                        halign: "center"
                        valign: "middle"
                        text_size: self.size
                        color: 0, 0, 0, 1

        # Mail overlay (right drawer like menu)
        FloatLayout:
            id: mail_overlay_root
            size_hint: None, None
            size: 0, 0
            opacity: 0
            disabled: True
            canvas.before:
                Color:
                    rgba: 0, 0, 0, 0.5
                Rectangle:
                    pos: self.pos
                    size: self.size
            Button:
                background_color: 0,0,0,0
                size_hint: 1, 1
                disabled: self.parent.disabled
                on_release: app.close_mail_overlay()
            BoxLayout:
                id: mail_panel
                orientation: "vertical"
                size_hint_y: 1
                size_hint_x: None
                width: root.width * 0.8
                x: root.width
                y: 0
                padding: dp(16), dp(24)
                spacing: dp(16)
                canvas.before:
                    Color:
                        rgba: 1, 1, 1, 1
                    Rectangle:
                        pos: self.pos
                        size: self.size
                BoxLayout:
                    orientation: "horizontal"
                    size_hint_y: None
                    height: dp(40)
                    spacing: dp(8)
                    MDLabel:
                        text: "Входящие"
                        halign: "left"
                        valign: "middle"
                        text_size: self.size
                        color: 0,0,0,1
                    MDIconButton:
                        icon: "close"
                        theme_text_color: "Custom"
                        text_color: 0,0,0,1
                        on_release: app.close_mail_overlay()
                ScrollView:
                    size_hint_x: 1
                    size_hint_y: 1
                    do_scroll_x: False
                    do_scroll_y: True
                    scroll_wheel_distance: dp(72)
                    scroll_type: ['bars', 'content']
                    bar_width: 0
                    effect_cls: "ScrollEffect"
                    MDBoxLayout:
                        id: mail_list
                        orientation: "vertical"
                        spacing: dp(10)
                        size_hint_y: None
                        height: self.minimum_height

        LoyaltyOverlay:
            id: loyalty_overlay_root

